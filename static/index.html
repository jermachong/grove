<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Technical Electives Course Map</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script
      type="text/javascript"
      src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"
    ></script>
    <style>
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        margin: 0;
        padding: 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 15px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(10px);
        overflow: hidden;
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .header {
        background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
        color: white;
        padding: 25px;
        text-align: center;
        position: relative;
        overflow: hidden;
      }

      .header::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)" /></svg>');
        opacity: 0.3;
      }

      .header h1 {
        position: relative;
        z-index: 1;
        margin: 0;
        font-size: 2.2em;
        font-weight: 300;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      }

      .controls {
        padding: 25px;
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        border-bottom: 3px solid #dee2e6;
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        align-items: center;
        box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
      }

      .control-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
        min-width: 120px;
      }

      .control-group label {
        font-weight: 600;
        color: #2c3e50;
        font-size: 0.9em;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .control-group select,
      .control-group input {
        border: 1px solid #bdc3c7;
        border-radius: 8px;
        padding: 10px;
        font-size: 14px;
        transition: all 0.3s ease;
        background: white;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .control-group select:focus,
      .control-group input:focus {
        outline: none;
        border-color: #3498db;
        box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        transform: translateY(-1px);
      }

      .control-group label {
        font-weight: bold;
        font-size: 14px;
        color: #495057;
      }

      select,
      input,
      button {
        padding: 8px 12px;
        border: 2px solid #dee2e6;
        border-radius: 5px;
        font-size: 14px;
      }

      button {
        background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        color: white;
        border: none;
        cursor: pointer;
        transition: all 0.3s ease;
        border-radius: 25px;
        padding: 12px 24px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
      }

      button:hover {
        background: linear-gradient(135deg, #2980b9 0%, #3498db 100%);
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
      }

      .btn-secondary {
        background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
        padding: 10px 20px;
        border-radius: 20px;
        font-size: 13px;
        box-shadow: 0 3px 10px rgba(149, 165, 166, 0.3);
      }

      .btn-secondary:hover {
        background: linear-gradient(135deg, #7f8c8d 0%, #95a5a6 100%);
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(149, 165, 166, 0.4);
      }

      .completed-courses {
        min-width: 200px;
      }

      .network-container {
        height: 600px;
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 15px;
        background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
        position: relative;
        overflow: hidden;
        box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(5px);
      }

      .flowchart-container {
        height: 600px;
        width: 100%;
        background: radial-gradient(
            circle at 25% 25%,
            rgba(52, 152, 219, 0.1) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 75% 75%,
            rgba(155, 89, 182, 0.1) 0%,
            transparent 50%
          ),
          linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
        position: relative;
        border-radius: 15px;
        overflow: hidden;
      }

      .course-card {
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1), 0 2px 5px rgba(0, 0, 0, 0.05);
        border-radius: 12px;
        position: relative;
        overflow: hidden;
        backdrop-filter: blur(10px);
      }

      .course-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.8) 0%,
          rgba(255, 255, 255, 0.6) 100%
        );
        z-index: -1;
      }

      .course-card:hover {
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15),
          0 4px 10px rgba(0, 0, 0, 0.1);
        transform: translateY(-3px) scale(1.02);
      }

      .course-card.completed {
        background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
        color: white;
      }

      .course-card.eligible {
        background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        color: white;
      }

      .course-card.not-eligible {
        background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        color: white;
      }

      .course-card.undergraduate {
        background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
        color: white;
      }

      .course-card.graduate {
        background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
        color: white;
      }

      .help-text {
        background: linear-gradient(
          135deg,
          rgba(52, 152, 219, 0.1) 0%,
          rgba(155, 89, 182, 0.1) 100%
        );
        border: 1px solid rgba(52, 152, 219, 0.3);
        border-radius: 12px;
        padding: 20px;
        margin: 15px 0;
        font-size: 14px;
        color: #2c3e50;
        box-shadow: 0 4px 15px rgba(52, 152, 219, 0.1);
        backdrop-filter: blur(5px);
        position: relative;
        overflow: hidden;
      }

      .help-text::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.4) 0%,
          transparent 100%
        );
        pointer-events: none;
      }

      .help-text strong {
        color: #3498db;
      }

      .zoom-controls {
        position: absolute;
        top: 10px;
        right: 10px;
        z-index: 1000;
        display: flex;
        flex-direction: column;
        gap: 5px;
      }

      .zoom-btn {
        background: rgba(255, 255, 255, 0.9);
        border: 1px solid #ccc;
        border-radius: 4px;
        padding: 5px 10px;
        cursor: pointer;
        font-size: 12px;
      }

      .zoom-btn:hover {
        background: white;
      }

      .legend {
        margin: 25px;
        padding: 20px;
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.9) 0%,
          rgba(248, 249, 250, 0.9) 100%
        );
        border-radius: 15px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1), 0 2px 8px rgba(0, 0, 0, 0.05);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .legend-item {
        display: inline-block;
        margin-right: 25px;
        margin-bottom: 12px;
        font-weight: 500;
        color: #34495e;
        transition: all 0.3s ease;
        cursor: pointer;
      }

      .legend-item:hover {
        transform: translateY(-1px);
      }

      .legend-color {
        display: inline-block;
        width: 24px;
        height: 24px;
        border-radius: 8px;
        margin-right: 10px;
        vertical-align: middle;
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2);
        position: relative;
        overflow: hidden;
      }

      .legend-color::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.3) 0%,
          transparent 100%
        );
      }

      .stats {
        margin: 25px;
        padding: 20px;
        background: linear-gradient(
          135deg,
          rgba(52, 152, 219, 0.1) 0%,
          rgba(155, 89, 182, 0.1) 100%
        );
        border-radius: 15px;
        border: 1px solid rgba(52, 152, 219, 0.2);
        backdrop-filter: blur(10px);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      }

      .stats h3 {
        color: #2c3e50;
        margin-bottom: 15px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .course-info {
        position: fixed;
        top: 20px;
        right: 20px;
        width: 320px;
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.95) 0%,
          rgba(248, 249, 250, 0.95) 100%
        );
        border: 1px solid rgba(52, 152, 219, 0.3);
        border-radius: 15px;
        padding: 20px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15),
          0 8px 16px rgba(0, 0, 0, 0.1);
        display: none;
        z-index: 1000;
        max-height: 450px;
        overflow-y: auto;
        backdrop-filter: blur(15px);
      }

      .course-info h3 {
        color: #2c3e50;
        margin-bottom: 15px;
        font-weight: 600;
        border-bottom: 2px solid #3498db;
        padding-bottom: 8px;
      }

      .eligible {
        background-color: #28a745;
      }
      .not-eligible {
        background-color: #dc3545;
      }
      .completed {
        background-color: #17a2b8;
      }
      .undergraduate {
        background-color: #ffc107;
      }
      .graduate {
        background-color: #6f42c1;
      }
      .prerequisite {
        background-color: #fd7e14;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>üéì Technical Electives Course Dependency Map</h1>
        <p>Interactive visualization of course prerequisites and eligibility</p>
      </div>

      <div class="controls">
        <div class="control-group">
          <label for="majorSelect">Major:</label>
          <select id="majorSelect" onchange="updateVisualization()">
            <option value="">All Majors</option>
            <option value="EE">Electrical Engineering (EE)</option>
            <option value="CpE">Computer Engineering (CpE)</option>
            <option value="EE2">EE2</option>
            <option value="CpE1">CpE1</option>
            <option value="EE3">EE3</option>
          </select>
        </div>

        <div class="control-group">
          <label for="levelSelect">Academic Level:</label>
          <select id="levelSelect">
            <option value="undergraduate">Undergraduate</option>
            <option value="graduate">Graduate</option>
          </select>
        </div>

        <div class="control-group">
          <label for="viewMode">View Mode:</label>
          <select id="viewMode" onchange="updateVisualization()">
            <option value="full">Full Dependency Map</option>
            <option value="simple">Simple List View</option>
            <option value="eligible">Eligible Courses Only</option>
          </select>
        </div>

        <div class="control-group">
          <label for="completedCourses">Completed Courses:</label>
          <input
            type="text"
            id="completedCourses"
            placeholder="e.g., EEL 3801C, EEE 3342C"
            style="width: 300px"
          />
        </div>

        <button onclick="checkEligibility()" class="btn-primary">
          Check Eligibility
        </button>
        <button onclick="clearCompleted()" class="btn-secondary">
          Clear Completed
        </button>
        <button onclick="fitNetwork()" class="btn-secondary">
          Fit to Screen
        </button>
        <button onclick="resetZoom()" class="btn-secondary">Reset Zoom</button>
      </div>

      <div class="legend">
        <h3>Legend:</h3>
        <div class="legend-item">
          <span class="legend-color eligible"></span>
          <span>Eligible to Take</span>
        </div>
        <div class="legend-item">
          <span class="legend-color completed"></span>
          <span>Completed</span>
        </div>
        <div class="legend-item">
          <span class="legend-color not-eligible"></span>
          <span>Prerequisites Missing</span>
        </div>
        <div class="legend-item">
          <span class="legend-color undergraduate"></span>
          <span>Undergraduate Course</span>
        </div>
        <div class="legend-item">
          <span class="legend-color graduate"></span>
          <span>Graduate Course</span>
        </div>
        <div class="legend-item">
          <span class="legend-color prerequisite"></span>
          <span>External Prerequisite</span>
        </div>
      </div>

      <div class="help-text">
        <strong>üí° Tips for using the map:</strong><br />
        ‚Ä¢ <strong>Simple List View:</strong> Easy to browse courses in a clean
        grid layout<br />
        ‚Ä¢ <strong>Full Dependency Map:</strong> Shows prerequisite connections
        (use zoom controls)<br />
        ‚Ä¢ <strong>Click courses</strong> to mark as completed ‚Ä¢
        <strong>Check Eligibility</strong> to see what you can take<br />
        ‚Ä¢ Use <strong>Fit to Screen</strong> and
        <strong>Reset Zoom</strong> buttons for better navigation
      </div>

      <div id="network" class="network-container">
        <div class="zoom-controls">
          <button class="zoom-btn" onclick="fitNetwork()">üìê Fit</button>
          <button class="zoom-btn" onclick="resetZoom()">üîÑ Reset</button>
        </div>
      </div>

      <div id="stats" class="stats">
        <h3>Statistics:</h3>
        <div id="statsContent">Loading...</div>
      </div>
    </div>

    <div id="courseInfo" class="course-info">
      <h3 id="courseTitle">Course Information</h3>
      <div id="courseDetails"></div>
    </div>

    <script>
      let network = null;
      let nodes = null;
      let edges = null;
      let completedCourses = [];

      // Initialize the application
      document.addEventListener("DOMContentLoaded", function () {
        loadStatistics();
        updateVisualization();
      });

      async function loadStatistics() {
        try {
          const response = await fetch("/api/stats");
          const stats = await response.json();

          const statsContent = document.getElementById("statsContent");
          statsContent.innerHTML = `
                    <p><strong>Total Courses:</strong> ${
                      stats.total_courses
                    }</p>
                    <p><strong>Undergraduate:</strong> ${
                      stats.undergraduate_courses
                    } | <strong>Graduate:</strong> ${stats.graduate_courses}</p>
                    <p><strong>Major Distribution:</strong> ${Object.entries(
                      stats.major_counts
                    )
                      .map(([major, count]) => `${major}: ${count}`)
                      .join(" | ")}</p>
                `;
        } catch (error) {
          console.error("Error loading statistics:", error);
        }
      }

      async function updateVisualization() {
        const major = document.getElementById("majorSelect").value;
        const url = major ? `/api/graph/${major}` : "/api/graph";

        try {
          const response = await fetch(url);
          const graphData = await response.json();

          // Check if we should use simple view
          if (createSimpleListView(graphData)) {
            return; // Simple view was created, exit early
          }

          // Create DataSets for network view
          nodes = new vis.DataSet(
            graphData.nodes.map((node) => ({
              ...node,
              color: getNodeColor(node),
              font: {
                size: 11,
                face: "Arial",
                strokeWidth: 1,
                strokeColor: "#000000",
              },
              shape: "box",
              margin: 8,
            }))
          );

          edges = new vis.DataSet(graphData.edges);

          // Create network
          const container = document.getElementById("network");
          const data = { nodes: nodes, edges: edges };
          const options = {
            layout: {
              hierarchical: {
                direction: "UD",
                sortMethod: "directed",
                levelSeparation: 100,
                nodeSpacing: 120,
                treeSpacing: 180,
                blockShifting: true,
                edgeMinimization: true,
                parentCentralization: true,
                shakeTowards: "roots",
              },
            },
            physics: {
              enabled: false,
            },
            nodes: {
              font: {
                color: "#ffffff",
                size: 12,
                face: "Segoe UI, Arial, sans-serif",
                strokeWidth: 2,
                strokeColor: "#2c3e50",
                multi: true,
              },
              borderWidth: 0,
              borderWidthSelected: 3,
              shape: "box",
              margin: 12,
              widthConstraint: { minimum: 100, maximum: 140 },
              heightConstraint: { minimum: 50 },
              shadow: {
                enabled: true,
                color: "rgba(0,0,0,0.2)",
                size: 8,
                x: 2,
                y: 2,
              },
              chosen: {
                node: function (values, id, selected, hovering) {
                  if (hovering) {
                    values.shadow = true;
                    values.shadowColor = "rgba(52, 152, 219, 0.6)";
                    values.shadowSize = 15;
                  }
                },
              },
            },
            edges: {
              arrows: {
                to: {
                  enabled: true,
                  scaleFactor: 1.2,
                  type: "arrow",
                },
              },
              color: {
                color: "#bdc3c7",
                highlight: "#3498db",
                inherit: false,
              },
              width: 3,
              smooth: {
                type: "cubicBezier",
                forceDirection: "vertical",
                roundness: 0.6,
              },
              selectionWidth: 4,
              shadow: {
                enabled: true,
                color: "rgba(0,0,0,0.1)",
                size: 5,
                x: 1,
                y: 1,
              },
            },
            interaction: {
              hover: true,
              selectConnectedEdges: true,
              dragNodes: false,
              dragView: true,
              zoomView: true,
              tooltipDelay: 200,
              multiselect: false,
            },
            configure: {
              enabled: false,
            },
          };

          if (network) {
            network.destroy();
          }

          network = new vis.Network(container, data, options);

          // Add event listeners
          network.on("click", function (params) {
            if (params.nodes.length > 0) {
              const nodeId = params.nodes[0];
              toggleCourseCompletion(nodeId);
            }
          });

          network.on("hoverNode", function (params) {
            const nodeId = params.node;
            const node = nodes.get(nodeId);
            showCourseInfo(node);
          });

          network.on("blurNode", function (params) {
            hideCourseInfo();
          });

          // Fit the network after a short delay to ensure proper rendering
          setTimeout(() => {
            network.fit({
              animation: {
                duration: 800,
                easingFunction: "easeInOutQuad",
              },
            });
          }, 100);
        } catch (error) {
          console.error("Error loading graph data:", error);
        }
      }

      function getNodeColor(node) {
        if (completedCourses.includes(node.id)) {
          return {
            background: "linear-gradient(135deg, #2ecc71 0%, #27ae60 100%)",
            border: "#27ae60",
            highlight: {
              background: "linear-gradient(135deg, #27ae60 0%, #2ecc71 100%)",
              border: "#229954",
            },
          };
        } else if (node.group === "graduate") {
          return {
            background: "linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%)",
            border: "#8e44ad",
            highlight: {
              background: "linear-gradient(135deg, #8e44ad 0%, #9b59b6 100%)",
              border: "#7d3c98",
            },
          };
        } else if (node.group === "undergraduate") {
          return {
            background: "linear-gradient(135deg, #f39c12 0%, #e67e22 100%)",
            border: "#e67e22",
            highlight: {
              background: "linear-gradient(135deg, #e67e22 0%, #f39c12 100%)",
              border: "#d35400",
            },
          };
        } else if (node.group === "prerequisite") {
          return {
            background: "linear-gradient(135deg, #e74c3c 0%, #c0392b 100%)",
            border: "#c0392b",
            highlight: {
              background: "linear-gradient(135deg, #c0392b 0%, #e74c3c 100%)",
              border: "#a93226",
            },
          };
        } else {
          return {
            background: "linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%)",
            border: "#7f8c8d",
            highlight: {
              background: "linear-gradient(135deg, #7f8c8d 0%, #95a5a6 100%)",
              border: "#6c7b7c",
            },
          };
        }
      }

      function toggleCourseCompletion(courseId) {
        const index = completedCourses.indexOf(courseId);
        if (index > -1) {
          completedCourses.splice(index, 1);
        } else {
          completedCourses.push(courseId);
        }

        // Update the input field
        document.getElementById("completedCourses").value =
          completedCourses.join(", ");

        // Update node colors
        if (nodes) {
          const node = nodes.get(courseId);
          if (node) {
            nodes.update({
              ...node,
              color: getNodeColor(node),
            });
          }
        }
      }

      async function checkEligibility() {
        const major = document.getElementById("majorSelect").value;
        const academicLevel = document.getElementById("levelSelect").value;
        const completedCoursesInput =
          document.getElementById("completedCourses").value;

        // Parse completed courses
        completedCourses = completedCoursesInput
          .split(",")
          .map((course) => course.trim().toUpperCase())
          .filter((course) => course.length > 0);

        try {
          const response = await fetch("/api/eligible", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              completed_courses: completedCourses,
              major: major || null,
              academic_level: academicLevel,
            }),
          });

          const eligibilityData = await response.json();

          // Update node colors based on eligibility
          if (nodes) {
            eligibilityData.forEach((course) => {
              const node = nodes.get(course.code);
              if (node) {
                let color;
                if (completedCourses.includes(course.code)) {
                  color = "#17a2b8"; // Completed
                } else if (course.prereqs_met) {
                  color = "#28a745"; // Eligible
                } else {
                  color = "#dc3545"; // Not eligible
                }

                nodes.update({
                  ...node,
                  color: color,
                });
              }
            });
          }

          // Update statistics
          const eligible = eligibilityData.filter(
            (c) => c.prereqs_met && !completedCourses.includes(c.code)
          );
          const ineligible = eligibilityData.filter(
            (c) => !c.prereqs_met && !completedCourses.includes(c.code)
          );

          const statsContent = document.getElementById("statsContent");
          statsContent.innerHTML += `
                    <hr>
                    <p><strong>Your Progress:</strong></p>
                    <p>‚úÖ Completed: ${completedCourses.length} courses</p>
                    <p>üü¢ Eligible to take: ${eligible.length} courses</p>
                    <p>üî¥ Need prerequisites: ${ineligible.length} courses</p>
                `;
        } catch (error) {
          console.error("Error checking eligibility:", error);
        }
      }

      function clearCompleted() {
        completedCourses = [];
        document.getElementById("completedCourses").value = "";
        updateVisualization();
      }

      function showCourseInfo(node) {
        const courseInfo = document.getElementById("courseInfo");
        const courseTitle = document.getElementById("courseTitle");
        const courseDetails = document.getElementById("courseDetails");

        courseTitle.textContent = node.id;
        courseDetails.innerHTML = `
                <p><strong>Majors:</strong> ${node.majors.join(", ")}</p>
                <p><strong>Level:</strong> ${
                  node.is_graduate ? "Graduate" : "Undergraduate"
                }</p>
                <p><strong>Prerequisites:</strong> ${
                  node.prerequisites.length > 0
                    ? node.prerequisites.join(", ")
                    : "None"
                }</p>
                <p><strong>Description:</strong> ${node.title}</p>
            `;

        courseInfo.style.display = "block";
      }

      function hideCourseInfo() {
        const courseInfo = document.getElementById("courseInfo");
        courseInfo.style.display = "none";
      }

      function fitNetwork() {
        if (network) {
          network.fit({
            animation: {
              duration: 1000,
              easingFunction: "easeInOutQuad",
            },
          });
        }
      }

      function resetZoom() {
        if (network) {
          network.moveTo({
            position: { x: 0, y: 0 },
            scale: 1,
            animation: {
              duration: 1000,
              easingFunction: "easeInOutQuad",
            },
          });
        }
      }

      function createSimpleListView(graphData) {
        const container = document.getElementById("network");
        const viewMode = document.getElementById("viewMode").value;

        if (viewMode === "simple" || viewMode === "eligible") {
          // Create a simple list instead of complex graph
          let coursesToShow = graphData.nodes;

          if (viewMode === "eligible") {
            // Only show courses that are eligible or completed
            coursesToShow = graphData.nodes.filter(
              (node) =>
                completedCourses.includes(node.id) ||
                node.group !== "not-eligible"
            );
          }

          container.innerHTML = `
            <div style="padding: 20px; max-height: 600px; overflow-y: auto;">
              <h3>Courses (${coursesToShow.length} total)</h3>
              <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px;">
                ${coursesToShow
                  .map((course) => {
                    const isCompleted = completedCourses.includes(course.id);
                    const cardClass = isCompleted
                      ? "completed"
                      : course.group === "graduate"
                      ? "graduate"
                      : course.group === "undergraduate"
                      ? "undergraduate"
                      : course.group === "prerequisite"
                      ? "not-eligible"
                      : "eligible";

                    return `
                  <div class="course-card ${cardClass}" 
                       style="border: none; 
                              border-radius: 12px; 
                              padding: 16px; 
                              cursor: pointer;
                              position: relative;
                              min-height: 120px;
                              display: flex;
                              flex-direction: column;
                              justify-content: space-between;"
                       onclick="toggleCourseCompletion('${course.id}')">
                    <div style="font-weight: 700; font-size: 16px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center;">
                      <span>${course.id}</span>
                      ${
                        isCompleted
                          ? '<span style="font-size: 20px;">‚úì</span>'
                          : ""
                      }
                    </div>
                    <div style="font-size: 13px; opacity: 0.9; margin-bottom: 10px; font-weight: 500;">
                      ${course.majors.join(", ")} | ${
                      course.is_graduate ? "Graduate" : "Undergraduate"
                    }
                    </div>
                    <div style="font-size: 12px; opacity: 0.8; line-height: 1.4;">
                      <strong>Prerequisites:</strong> ${
                        course.prerequisites.length > 0
                          ? course.prerequisites.join(", ")
                          : "None"
                      }
                    </div>
                  </div>
                `;
                  })
                  .join("")}
              </div>
            </div>
          `;
          return true; // Indicates we used simple view
        }
        return false; // Indicates we should use network view
      }

      // Parse completed courses from input
      document
        .getElementById("completedCourses")
        .addEventListener("input", function (e) {
          const input = e.target.value;
          completedCourses = input
            .split(",")
            .map((course) => course.trim().toUpperCase())
            .filter((course) => course.length > 0);
        });
    </script>
  </body>
</html>
